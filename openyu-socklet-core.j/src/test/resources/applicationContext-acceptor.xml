<?xml version="1.0" encoding="UTF-8"?>

<beans
	xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:p="http://www.springframework.org/schema/p"
	xmlns:util="http://www.springframework.org/schema/util"
	xsi:schemaLocation="
             http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.0.xsd
             http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-2.0.xsd
             ">
	<bean
		id="messageService"
		class="org.openyu.socklet.message.service.impl.MessageServiceImpl"
		parent="baseServiceSupporter" />

	<bean
		id="protocolService"
		class="org.openyu.socklet.message.service.impl.ProtocolServiceFactoryBean"
		parent="baseServiceFactorySupporter"
		p:configLocation="file:src/test/config/etc/ProtocolService.properties" />

	<!-- acceptor -->
	<bean
		id="acceptorThreadService"
		class="org.openyu.commons.thread.impl.ThreadServiceFactoryBean"
		parent="threadService"
		p:configLocation="file:src/test/config/etc/AcceptorThreadService.properties" />

	<bean
		id="acceptorServiceSupporter"
		class="org.openyu.socklet.acceptor.service.impl.AcceptorServiceImpl"
		parent="baseServiceSupporter"
		abstract="true"
		p:threadService-ref="acceptorThreadService" />

	<bean
		id="acceptorSupporter"
		parent="acceptorServiceSupporter"
		abstract="true"
		p:moduleTypeName="org.openyu.socklet.core.net.socklet.CoreModuleType"
		p:messageTypeName="org.openyu.socklet.core.net.socklet.CoreMessageType" />
			
	<!-- socklet -->
	<bean
		id="sockletThreadService"
		class="org.openyu.commons.thread.impl.ThreadServiceFactoryBean"
		parent="threadService"
		p:configLocation="file:src/test/config/etc/SockletThreadService.properties" />

	<bean
		id="sockletServiceSupporter"
		class="org.openyu.socklet.socklet.service.supporter.SockletServiceSupporter"
		parent="baseServiceSupporter"
		abstract="true"
		p:threadService-ref="sockletThreadService" />
		
	<!--listener -->
	<bean
		id="contextListenerSupporter"
		class="org.openyu.socklet.context.service.event.supporter.ContextListenerSupporter"
		parent="baseListenerSupporter"
		abstract="true" />

	<bean
		id="relationListenerSupporter"
		class="org.openyu.socklet.acceptor.service.event.supporter.RelationListenerSupporter"
		parent="baseListenerSupporter"
		abstract="true" />

	<bean
		id="sessionListenerSupporter"
		class="org.openyu.socklet.session.service.event.supporter.SessionListenerSupporter"
		parent="baseListenerSupporter"
		abstract="true" />	
		
	<!-- system -->
	<bean
		id="systemContextAdapter"
		class="org.openyu.socklet.context.service.event.adapter.ContextAdapter"
		parent="contextListenerSupporter"
		abstract="true"
		p:acceptors-ref="systemContextAdapterAcceptors" />

	<util:set
		id="systemContextAdapterAcceptors"
		set-class="java.util.LinkedHashSet">
		<value>system</value>
	</util:set>

	<bean
		id="systemRelationAdapter"
		class="org.openyu.socklet.acceptor.service.event.adapter.RelationAdapter"
		parent="relationListenerSupporter"
		abstract="true"
		p:acceptors-ref="systemRelationAdapterAcceptors" />

	<util:set
		id="systemRelationAdapterAcceptors"
		set-class="java.util.LinkedHashSet">
		<value>system</value>
	</util:set>

	<!-- slave -->
	<bean
		id="slaveSessionAdapter"
		class="org.openyu.socklet.session.service.event.adapter.SessionAdapter"
		parent="sessionListenerSupporter"
		abstract="true"
		p:acceptors-ref="slaveSessionAdapterAcceptors" />

	<util:set
		id="slaveSessionAdapterAcceptors"
		set-class="java.util.LinkedHashSet">
		<value>slave1</value>
		<value>slave2</value>
		<value>slave3</value>
		<value>slave4</value>
		<value>slave5</value>
		<value>slave6</value>
		<value>slave7</value>
		<value>slave8</value>
		<value>slave9</value>
		<value>slave10</value>
	</util:set>	

	<!-- system, slave -->
	<bean
		id="systemSlaveSessionAdapter"
		class="org.openyu.socklet.session.service.event.adapter.SessionAdapter"
		parent="sessionListenerSupporter"
		abstract="true"
		p:acceptors-ref="systemSlaveSessionAdapterAcceptors" />

	<util:set
		id="systemSlaveSessionAdapterAcceptors"
		set-class="java.util.LinkedHashSet">
		<value>system</value>
		<value>slave1</value>
		<value>slave2</value>
		<value>slave3</value>
		<value>slave4</value>
		<value>slave5</value>
		<value>slave6</value>
		<value>slave7</value>
		<value>slave8</value>
		<value>slave9</value>
		<value>slave10</value>
	</util:set>

	<!-- account -->
	<bean
		id="accountAcceptor"
		parent="acceptorSupporter">
		<property
			name="id"
			value="account" />
		<property
			name="instanceId"
			value="01" />
		<property
			name="outputId"
			value="01" />
		<property name="relationServers">
			<list>
				<value>127.0.0.1:3000</value>
				<value>127.0.0.1:3001</value>
			</list>
		</property>
		<property name="clientServers">
			<list>
				<value>127.0.0.1:10000</value>
				<value>127.0.0.1:10001</value>
			</list>
		</property>
		<property
			name="maxClient"
			value="1000" />
		<property
			name="cluster"
			value="socklet" />
		<property name="relations">
			<list>
			</list>
		</property>
		<property
			name="relationRetryNumber"
			value="1" />
		<property
			name="relationRetryPauseMills"
			value="1000" />
		<property name="initParameters">
			<props>
				<prop key="debug">7</prop>
			</props>
		</property>
	</bean>

	<!-- login -->
	<bean
		id="loginAcceptor"
		parent="acceptorSupporter">
		<property
			name="id"
			value="login" />
		<property
			name="instanceId"
			value="01" />
		<property
			name="outputId"
			value="01" />
		<property name="relationServers">
			<list>
				<value>127.0.0.1:3100</value>
				<value>127.0.0.1:3101</value>
			</list>
		</property>
		<property name="clientServers">
			<list>
				<value>127.0.0.1:10100</value>
				<value>127.0.0.1:10101</value>
			</list>
		</property>
		<property
			name="maxClient"
			value="1000" />
		<property
			name="cluster"
			value="socklet" />
		<property name="relations">
			<list>
				<value>account</value>
			</list>
		</property>
		<property
			name="relationRetryNumber"
			value="1" />
		<property
			name="relationRetryPauseMills"
			value="1000" />
		<property name="initParameters">
			<props>
				<prop key="debug">7</prop>
			</props>
		</property>
	</bean>
	
	<!-- master -->
	<bean
		id="masterAcceptor"
		parent="acceptorSupporter">
		<property
			name="id"
			value="master" />
		<property
			name="instanceId"
			value="01" />
		<property
			name="outputId"
			value="01" />
		<property name="relationServers">
			<list>
				<value>127.0.0.1:3200</value>
				<value>127.0.0.1:3201</value>
			</list>
		</property>
		<property name="clientServers">
			<list>
				<value>127.0.0.1:10200</value>
				<value>127.0.0.1:10201</value>
			</list>
		</property>
		<property
			name="maxClient"
			value="1000" />
		<property
			name="cluster"
			value="socklet" />
		<property name="relations">
			<list>
				<value>account</value>
				<value>login</value>
			</list>
		</property>
		<property
			name="relationRetryNumber"
			value="1" />
		<property
			name="relationRetryPauseMills"
			value="1000" />
		<property name="initParameters">
			<props>
				<prop key="debug">7</prop>
			</props>
		</property>
	</bean>

</beans>